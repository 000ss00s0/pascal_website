<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестирование по теме конструирование алгоритмов</title>
    <link rel="stylesheet" href="test5_style.css">
</head>
<body>
    <div class="header">
        <button onclick="window.location.href = 'general.php';">Главная</button>
        <button onclick="window.location.href = 'courses.php';">Курсы</button>
        <button onclick="window.location.href = 'tests.php';">Тесты</button>
        <button onclick="window.location.href = 'personal_area.php';">Личный кабинет</button>  
    </div>

    <h1>Конструирование алгоритмов</h1>

    <form id="quizForm" action="test5.php" method="post">
        
        <div class="question-menu" id="questionMenu"></div> <!-- Меню вопросов -->
        <div class="question" style="display: block;">
            <p>Вопрос 1: Подпрограмма, имеющая произвольное количество входных и выходных данных, называется?</p>
            <input type="radio" name="q1" value="1" id="q1a1" class="answer">
            <label for="q1a1">Процедурой</label><br>
            <input type="radio" name="q1" value="2" id="q1a2" class="answer">
            <label for="q1a2">Функцией</label><br>
            <input type="radio" name="q1" value="3" id="q1a3" class="answer">
            <label for="q1a3">Вспомогательным алгоритмом</label><br>
            <input type="radio" name="q1" value="4" id="q1a4" class="answer" title="Тот самый Паскаль Фантазийный, который во сне получил от компьютерного эльфа книгу с инструкциями по созданию языка программирования.">
            <label for="q1a4">Алгоритмом</label><br>
        </div>

        <div class="question" style="display: none;">
            <p>Вопрос 2: Подпрограмма, имеющая единственный результат, записываемый в ячейку памяти, имя которой совпадает с именем функции, называется?</p>
            <input type="radio" name="q2" value="1" id="q2a1" class="answer">
            <label for="q2a1">Процедурой</label><br>
            <input type="radio" name="q2" value="2" id="q2a2" class="answer">
            <label for="q2a2">Функцией</label><br>
            <input type="radio" name="q2" value="3" id="q2a3" class="answer">
            <label for="q2a3">Вспомогательным алгоритмом</label><br>
            <input type="radio" name="q2" value="4" id="q2a4" class="answer">
            <label for="q2a4">Алгоритмом</label><br>
        </div>

        <div class="question" style="display: none;">
            <p>Вопрос 3: Что такое управление? Выберите самое полное определение:</p>
            <input type="radio" name="q3" value="1" id="q3a1" class="answer">
            <label for="q3a1">Перевод объекта из одного состояния в другое </label><br>
            <input type="radio" name="q3" value="2" id="q3a2" class="answer">
            <label for="q3a2">Удержание объекта в существующем состоянии </label><br>
            <input type="radio" name="q3" value="3" id="q3a3" class="answer">
            <label for="q3a3">Процесс целенаправленного воздействия одних объектов на другие объекты</label><br>
            <input type="radio" name="q3" value="4" id="q3a4" class="answer">
            <label for="q3a4">Регулирование движения автомашин на перекрёстке</label><br>
        </div>

        <div class="question" style="display: none;">
            <p>Вопрос 4: Для управления нужна?</p>
            <input type="radio" name="q4" value="1" id="q4a1" class="answer">
            <label for="q4a1">Информация </label><br>
            <input type="radio" name="q4" value="2" id="q4a2" class="answer">
            <label for="q4a2">Энергия</label><br>
            <input type="radio" name="q4" value="3" id="q4a3" class="answer">
            <label for="q4a3">Вода</label><br>
            <input type="radio" name="q4" value="4" id="q4a4" class="answer">
            <label for="q4a4">Человек</label><br>
        </div>

        <div class="question" style="display: none;">
            <p>Вопрос 5: Подпрограмма, имеющая произвольное количество входных и выходных данных, называется?</p>
            <input type="radio" name="q5" value="1" id="q5a1" class="answer">
            <label for="q5a1">функцией </label><br>
            <input type="radio" name="q5" value="2" id="q5a2" class="answer">
            <label for="q5a2">вспомогательным алгоритмом</label><br>
            <input type="radio" name="q5" value="3" id="q5a3" class="answer">
            <label for="q5a3">алгоритмом </label><br>
            <input type="radio" name="q5" value="4" id="q5a4" class="answer">
            <label for="q5a4">процедурой </label><br>
        </div>

        <button type="button" id="nextQuestionButton" class="nextQuestionButton" onclick="showNextQuestion()">Следующий вопрос</button>
        <input type="submit" value="Завершить" id="checkAnswersButton" class="checkAnswersButton hidden">
    </form>
    
    <script>
        const questions = document.querySelectorAll('.question'); // Получаем все вопросы
        const questionMenu = document.getElementById('questionMenu'); // Получаем меню вопросов
        let currentQuestionIndex = 0; // Индекс текущего вопроса

        questions.forEach((question, index) => {
            // Создаем элемент списка для меню вопросов
            const listItem = document.createElement('div');
            listItem.classList.add('question-menu-item');
            listItem.innerHTML = `<a href="#question${index + 1}" onclick="showQuestion(${index})" id="qMenu${index + 1}">Вопрос ${index + 1}</a>`;
            questionMenu.appendChild(listItem);
        });
        function showQuestion(index) {
            // Показываем кнопку "Следующий вопрос" или "Проверить ответы" в зависимости от индекса
            if (index < questions.length - 1) {
                console.log("Показываем кнопку 'Следующий вопрос'");
                document.getElementById('nextQuestionButton').classList.remove('hidden');
                document.getElementById('checkAnswersButton').classList.add('hidden');
            } else {
                console.log("Показываем кнопку 'Проверить ответы'");
                document.getElementById('nextQuestionButton').classList.add('hidden');
                document.getElementById('checkAnswersButton').classList.remove('hidden');
            }

            // Скрываем текущий вопрос и отображаем выбранный
            questions[currentQuestionIndex].style.display = 'none';
            currentQuestionIndex = index;
            questions[currentQuestionIndex].style.display = 'block';
        }

        function showNextQuestion() {
            const nextIndex = currentQuestionIndex + 1;
            if (nextIndex < questions.length) {
                showQuestion(nextIndex);
            }
        }

        document.getElementById('quizForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const q1Answer = document.querySelector('input[name="q1"]:checked');
            const q2Answer = document.querySelector('input[name="q2"]:checked');
            const q3Answer = document.querySelector('input[name="q3"]:checked');
            const q4Answer = document.querySelector('input[name="q4"]:checked');
            const q5Answer = document.querySelector('input[name="q5"]:checked');

            if (!q1Answer || !q2Answer || !q3Answer || !q4Answer || !q5Answer) {
                alert('Вы не ответили на все вопросы');
                return;
            }

            const answers = [
                q1Answer.value,
                q2Answer.value,
                q3Answer.value,
                q4Answer.value,
                q5Answer.value
            ];

            const correctAnswers = ['1', '2', '3', '1', '4'];

            let score = 0;
            for (let i = 0; i < answers.length; i++) {
                if (answers[i] === correctAnswers[i]) {
                    score++;
                } else {
                    const selectedAnswer = document.querySelector(`input[name="q${i + 1}"][value="${answers[i]}"]`);
                    if (selectedAnswer) {
                        const labelForAnswer = document.querySelector(`label[for="${selectedAnswer.id}"]`);
                        if (labelForAnswer) {
                            labelForAnswer.style.color = 'red';
                        }
                    }
                }
            }

            alert('Вы дали ' + score + ' правильных ответов из ' + answers.length);

            const formData = new FormData(this);
            fetch('test5.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json()) // Преобразуем ответ в JSON
            .then(result => {
                if (result.success) {
                    alert(`Ваши баллы: ${result.score}`); // Выводим только количество баллов
                } else {
                    console.error('Ошибка:', result.error); // Обрабатываем ошибку
                }
            })
            .catch(error => {
                console.error('Ошибка при отправке формы:', error);
            });
        });
    </script>  
</body>
</html>
